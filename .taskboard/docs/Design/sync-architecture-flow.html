<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klarity + Orbit ‚Äî Sync Architecture Flow v4.0</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: #0a0a0f;
            color: #e4e4e7;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
            padding: 40px 24px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 56px;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 14px;
            color: #71717a;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.5;
        }

        /* ===== SYSTEM OVERVIEW ===== */
        .systems-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr auto 1fr;
            gap: 0;
            max-width: 1000px;
            margin: 0 auto 24px;
            align-items: center;
        }

        .claude-direct-section {
            max-width: 1000px;
            margin: 0 auto 64px;
        }

        .claude-direct-label {
            text-align: center;
            margin-bottom: 16px;
        }

        .claude-direct-label span {
            display: inline-block;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: #34d399;
            padding: 4px 16px;
            background: rgba(16, 185, 129, 0.08);
            border: 1px solid rgba(16, 185, 129, 0.15);
            border-radius: 16px;
        }

        .claude-direct-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr auto 1fr;
            gap: 0;
            align-items: center;
            padding: 28px 24px;
            background: rgba(16, 185, 129, 0.02);
            border: 1px dashed rgba(16, 185, 129, 0.12);
            border-radius: 16px;
        }

        .claude-direct-grid .system-box.vscode {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(16, 185, 129, 0.02));
            border: 1px solid rgba(16, 185, 129, 0.15);
        }

        .system-tag.vscode { background: rgba(16, 185, 129, 0.15); color: #34d399; }

        .system-box {
            padding: 24px 20px;
            border-radius: 16px;
            text-align: center;
            position: relative;
        }

        .system-box.orbit {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(139, 92, 246, 0.02));
            border: 1px solid rgba(139, 92, 246, 0.15);
        }

        .system-box.github {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(59, 130, 246, 0.02));
            border: 1px solid rgba(59, 130, 246, 0.15);
        }

        .system-box.klarity {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.08), rgba(6, 182, 212, 0.02));
            border: 1px solid rgba(6, 182, 212, 0.15);
        }

        .system-icon {
            font-size: 36px;
            margin-bottom: 8px;
        }

        .system-name {
            font-size: 16px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 4px;
        }

        .system-desc {
            font-size: 11px;
            color: #71717a;
        }

        .system-tag {
            display: inline-block;
            margin-top: 8px;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .system-tag.phone { background: rgba(139, 92, 246, 0.15); color: #a78bfa; }
        .system-tag.cloud { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
        .system-tag.desktop { background: rgba(6, 182, 212, 0.15); color: #22d3ee; }

        .system-arrow {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 0 12px;
        }

        .system-arrow .arrow-line {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #3f3f46;
            font-size: 18px;
        }

        .system-arrow .arrow-label {
            font-size: 9px;
            color: #52525b;
            text-align: center;
            line-height: 1.3;
        }

        /* ===== FLOW SECTION ===== */
        .section-title {
            max-width: 900px;
            margin: 0 auto 32px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .section-title h2 {
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            white-space: nowrap;
        }

        .section-title .line {
            flex: 1;
            height: 1px;
            background: linear-gradient(to right, rgba(255,255,255,0.1), transparent);
        }

        .flow-container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .flow-container::before {
            content: '';
            position: absolute;
            left: 28px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom,
                #8b5cf6 0%, #3b82f6 15%, #06b6d4 30%,
                #f59e0b 45%, #10b981 55%, #10b981 70%,
                #ec4899 82%, #8b5cf6 100%);
            opacity: 0.2;
        }

        .phase {
            margin-bottom: 36px;
        }

        .phase-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border-radius: 20px;
            padding: 6px 16px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 16px;
            margin-left: 56px;
        }

        .phase-label.orbit-phase {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.2);
            color: #a78bfa;
        }

        .phase-label.github-phase {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        .phase-label.klarity-phase {
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.2);
            color: #22d3ee;
        }

        .phase-label.notify-phase {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.2);
            color: #fbbf24;
        }

        .phase-label.claude-phase {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: #34d399;
        }

        .phase-label.sync-phase {
            background: rgba(236, 72, 153, 0.1);
            border: 1px solid rgba(236, 72, 153, 0.2);
            color: #f472b6;
        }

        .step {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            margin-bottom: 12px;
        }

        .step-number {
            width: 56px;
            min-width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .step-number.orbit { background: linear-gradient(135deg, #8b5cf6, #a855f7); color: #fff; }
        .step-number.github { background: linear-gradient(135deg, #3b82f6, #6366f1); color: #fff; }
        .step-number.klarity { background: linear-gradient(135deg, #06b6d4, #0891b2); color: #fff; }
        .step-number.notify { background: linear-gradient(135deg, #f59e0b, #d97706); color: #fff; }
        .step-number.claude { background: linear-gradient(135deg, #10b981, #059669); color: #fff; }
        .step-number.sync { background: linear-gradient(135deg, #ec4899, #db2777); color: #fff; }

        .step-card {
            flex: 1;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 16px 20px;
            transition: all 0.2s;
        }

        .step-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .step-card h3 {
            font-size: 15px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 4px;
        }

        .step-card p {
            font-size: 13px;
            color: #a1a1aa;
            line-height: 1.5;
        }

        .step-card .detail {
            margin-top: 10px;
            padding: 10px 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
            font-size: 12px;
            color: #71717a;
            line-height: 1.6;
        }

        .step-card .detail code {
            color: #a78bfa;
        }

        .step-card .timing {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
            padding: 3px 10px;
            background: rgba(245, 158, 11, 0.08);
            border: 1px solid rgba(245, 158, 11, 0.15);
            border-radius: 8px;
            font-size: 11px;
            color: #fbbf24;
        }

        .step-card .data-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
            margin-right: 6px;
            padding: 3px 10px;
            background: rgba(59, 130, 246, 0.08);
            border: 1px solid rgba(59, 130, 246, 0.15);
            border-radius: 8px;
            font-size: 11px;
            color: #60a5fa;
        }

        /* ===== NOTIFICATION MOCK ===== */
        .notif-mock {
            margin-top: 12px;
            padding: 14px 16px;
            background: rgba(245, 158, 11, 0.05);
            border: 1px solid rgba(245, 158, 11, 0.12);
            border-radius: 12px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .notif-mock .notif-icon {
            font-size: 20px;
            margin-top: 2px;
        }

        .notif-mock .notif-content {
            flex: 1;
        }

        .notif-mock .notif-title {
            font-size: 13px;
            font-weight: 600;
            color: #fbbf24;
            margin-bottom: 2px;
        }

        .notif-mock .notif-body {
            font-size: 12px;
            color: #a1a1aa;
        }

        .notif-mock .notif-app {
            font-size: 10px;
            color: #52525b;
            margin-top: 4px;
        }

        /* ===== LOOP INDICATOR ===== */
        .loop-indicator {
            max-width: 900px;
            margin: 16px auto 48px;
            padding: 16px 24px;
            background: rgba(236, 72, 153, 0.04);
            border: 1px dashed rgba(236, 72, 153, 0.15);
            border-radius: 12px;
            text-align: center;
        }

        .loop-indicator .loop-icon {
            font-size: 24px;
            margin-bottom: 6px;
        }

        .loop-indicator .loop-text {
            font-size: 13px;
            color: #f472b6;
            font-weight: 500;
        }

        .loop-indicator .loop-sub {
            font-size: 11px;
            color: #71717a;
            margin-top: 4px;
        }

        /* ===== PROTOCOL TABLE ===== */
        .protocol-section {
            max-width: 900px;
            margin: 0 auto 48px;
        }

        .protocol-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .protocol-card {
            padding: 20px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
        }

        .protocol-card .pc-label {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .protocol-card.etag .pc-label { color: #60a5fa; }
        .protocol-card.merge .pc-label { color: #a78bfa; }
        .protocol-card.notify .pc-label { color: #fbbf24; }
        .protocol-card.pushback .pc-label { color: #f472b6; }

        .protocol-card .pc-title {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 6px;
        }

        .protocol-card .pc-desc {
            font-size: 12px;
            color: #71717a;
            line-height: 1.5;
        }

        /* ===== CONFIG EXAMPLE ===== */
        .config-section {
            max-width: 900px;
            margin: 0 auto 48px;
        }

        .config-block {
            margin-top: 16px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
            font-size: 13px;
            line-height: 1.6;
            overflow-x: auto;
        }

        .config-block .key { color: #60a5fa; }
        .config-block .str { color: #34d399; }
        .config-block .num { color: #fbbf24; }
        .config-block .comment { color: #52525b; }

        /* ===== LEGEND ===== */
        .legend {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
            max-width: 900px;
            margin: 48px auto 0;
            padding-top: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.06);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #71717a;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-dot.orbit { background: linear-gradient(135deg, #8b5cf6, #a855f7); }
        .legend-dot.github { background: linear-gradient(135deg, #3b82f6, #6366f1); }
        .legend-dot.klarity { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .legend-dot.notify { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .legend-dot.claude { background: linear-gradient(135deg, #10b981, #059669); }
        .legend-dot.sync { background: linear-gradient(135deg, #ec4899, #db2777); }

        .footer {
            text-align: center;
            margin-top: 32px;
            font-size: 11px;
            color: #3f3f46;
        }

        /* ===== STATUS BADGE ===== */
        .status-live {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 6px 16px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.25);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: #34d399;
        }

        .status-live .pulse {
            width: 8px;
            height: 8px;
            background: #34d399;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(52, 211, 153, 0.4); }
            50% { opacity: 0.8; box-shadow: 0 0 0 6px rgba(52, 211, 153, 0); }
        }

        /* ===== LINKEDIN COMPACT SECTION ===== */
        .linkedin-section {
            max-width: 900px;
            margin: 64px auto 0;
            padding-top: 48px;
            border-top: 2px solid rgba(255, 255, 255, 0.06);
        }

        .linkedin-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            background: rgba(10, 102, 194, 0.15);
            border: 1px solid rgba(10, 102, 194, 0.25);
            border-radius: 16px;
            font-size: 10px;
            font-weight: 600;
            color: #4fa3e3;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            margin-bottom: 24px;
        }

        .linkedin-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.04), rgba(255, 255, 255, 0.01));
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .linkedin-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(to right, #8b5cf6, #3b82f6, #06b6d4, #10b981);
        }

        .linkedin-card .lc-title {
            font-size: 26px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .linkedin-card .lc-subtitle {
            font-size: 14px;
            color: #a1a1aa;
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .linkedin-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .lf-node {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-width: 90px;
        }

        .lf-node .lf-icon {
            width: 52px;
            height: 52px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .lf-node .lf-icon.orbit-bg { background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(139, 92, 246, 0.05)); border: 1px solid rgba(139, 92, 246, 0.3); }
        .lf-node .lf-icon.github-bg { background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(59, 130, 246, 0.05)); border: 1px solid rgba(59, 130, 246, 0.3); }
        .lf-node .lf-icon.klarity-bg { background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(6, 182, 212, 0.05)); border: 1px solid rgba(6, 182, 212, 0.3); }
        .lf-node .lf-icon.claude-bg { background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.05)); border: 1px solid rgba(16, 185, 129, 0.3); }

        .lf-node .lf-name {
            font-size: 11px;
            font-weight: 600;
            color: #e4e4e7;
        }

        .lf-node .lf-role {
            font-size: 9px;
            color: #71717a;
            text-align: center;
        }

        .lf-arrow {
            font-size: 20px;
            color: #3f3f46;
            padding: 0 8px;
            margin-bottom: 20px;
        }

        .linkedin-features {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 28px;
        }

        .linkedin-feat {
            text-align: center;
            padding: 16px 8px;
        }

        .linkedin-feat .feat-num {
            font-size: 28px;
            font-weight: 800;
            color: #fff;
            margin-bottom: 4px;
        }

        .linkedin-feat .feat-label {
            font-size: 10px;
            color: #71717a;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .linkedin-tech-row {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .linkedin-tech {
            padding: 5px 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            font-size: 11px;
            color: #a1a1aa;
        }

        @media (max-width: 768px) {
            .linkedin-features { grid-template-columns: repeat(2, 1fr); }
            .linkedin-flow { gap: 4px; }
            .lf-node { min-width: 70px; }
            .linkedin-card { padding: 24px; }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 960px) {
            .protocol-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .systems-grid { grid-template-columns: 1fr; gap: 16px; }
            .claude-direct-row { flex-direction: column; }
            .system-arrow { transform: rotate(90deg); padding: 8px 0; }
            .protocol-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Klarity + Orbit ‚Äî Sync Architecture</h1>
        <p>How data flows between Orbit (phone), GitHub (.taskboard repo), Klarity (desktop), and Claude Code (VS Code)</p>
        <div class="status-live"><div class="pulse"></div>SYNC LIVE ‚Äî GitHub repo active, round-trip verified</div>
    </div>

    <!-- ===== SYSTEM OVERVIEW ===== -->
    <div class="systems-grid">
        <div class="system-box orbit">
            <div class="system-icon">üì±</div>
            <div class="system-name">Orbit</div>
            <div class="system-desc">Mobile companion app</div>
            <div class="system-tag phone">PHONE</div>
        </div>

        <div class="system-arrow">
            <div class="arrow-line">‚îÄ‚îÄ writes ‚îÄ‚îÄ‚ñ∂</div>
            <div class="arrow-label">GitHub<br>Contents API</div>
        </div>

        <div class="system-box github">
            <div class="system-icon">üîí</div>
            <div class="system-name">.taskboard</div>
            <div class="system-desc">Private GitHub repo</div>
            <div class="system-tag cloud">CLOUD</div>
        </div>

        <div class="system-arrow">
            <div class="arrow-line">‚óÄ‚îÄ‚îÄ polls ‚îÄ‚îÄ</div>
            <div class="arrow-label">Pull: every 2 min<br>with ETag</div>
            <div class="arrow-line" style="margin-top: 4px;">‚îÄ‚îÄ pushes ‚îÄ‚îÄ‚ñ∂</div>
            <div class="arrow-label">Push: on save<br>with SHA</div>
        </div>

        <div class="system-box klarity">
            <div class="system-icon">üñ•Ô∏è</div>
            <div class="system-name">Klarity</div>
            <div class="system-desc">Desktop command center</div>
            <div class="system-tag desktop">WINDOWS</div>
        </div>
    </div>

    <!-- Claude Code bidirectional row -->
    <div class="claude-direct-section">
        <div class="claude-direct-label">
            <span>Orbit ‚Üî Claude ‚Äî fully independent of Klarity</span>
        </div>
        <div class="claude-direct-grid">
            <div class="system-box orbit">
                <div class="system-icon">üì±</div>
                <div class="system-name">Orbit</div>
                <div class="system-desc">Sends task</div>
                <div class="system-tag phone">PHONE</div>
            </div>

            <div class="system-arrow">
                <div class="arrow-line">‚îÄ‚îÄ writes ‚îÄ‚îÄ‚ñ∂</div>
            </div>

            <div class="system-box github">
                <div class="system-icon">üîí</div>
                <div class="system-name">.taskboard</div>
                <div class="system-desc">inbox.json</div>
                <div class="system-tag cloud">CLOUD</div>
            </div>

            <div class="system-arrow">
                <div class="arrow-line">‚óÄ‚îÄ‚îÄ sync-pull.sh ‚îÄ‚îÄ</div>
                <div class="arrow-label">Session start</div>
                <div class="arrow-line" style="margin-top: 4px;">‚îÄ‚îÄ sync-push.sh ‚îÄ‚îÄ‚ñ∂</div>
                <div class="arrow-label">After reply</div>
            </div>

            <div class="system-box vscode">
                <div class="system-icon">‚ö°</div>
                <div class="system-name">Claude Code</div>
                <div class="system-desc">Pull + Execute + Push</div>
                <div class="system-tag vscode">BIDIRECTIONAL</div>
            </div>
        </div>
    </div>

    <!-- ===== FLOW: VOICE NOTE ON PHONE ===== -->
    <div class="section-title">
        <h2>Flow: Voice Note ‚Üí Desktop Notification ‚Üí Claude Reply ‚Üí Orbit</h2>
        <div class="line"></div>
    </div>

    <div class="flow-container">

        <!-- ORBIT -->
        <div class="phase">
            <div class="phase-label orbit-phase">Orbit (Phone)</div>

            <div class="step">
                <div class="step-number orbit">1</div>
                <div class="step-card">
                    <h3>User captures a voice note or adds an inbox item</h3>
                    <p>On the phone ‚Äî could be while commuting, in a meeting, or in bed at night. The idea gets captured instantly via voice or text.</p>
                    <div class="data-badge">inbox item created</div>
                    <div class="data-badge">author: user</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number orbit">2</div>
                <div class="step-card">
                    <h3>Orbit writes to GitHub .taskboard repo</h3>
                    <p>The new inbox item is appended to <code>inbox.json</code> and committed via GitHub Contents API directly from the phone.</p>
                    <div class="detail">
                        <code>PUT /repos/{user}/.taskboard/contents/inbox.json</code><br>
                        Commit: <code>"Add inbox item: Fix splash screen timing"</code>
                    </div>
                </div>
            </div>
        </div>

        <!-- GITHUB -->
        <div class="phase">
            <div class="phase-label github-phase">GitHub (.taskboard repo)</div>

            <div class="step">
                <div class="step-number github">3</div>
                <div class="step-card">
                    <h3>inbox.json updated on GitHub</h3>
                    <p>The private repo now contains the latest inbox data. A new SHA and ETag are generated for the file.</p>
                    <div class="data-badge">new ETag generated</div>
                    <div class="data-badge">new SHA</div>
                </div>
            </div>
        </div>

        <!-- KLARITY SYNC -->
        <div class="phase">
            <div class="phase-label klarity-phase">Klarity Sync Poller</div>

            <div class="step">
                <div class="step-number klarity">4</div>
                <div class="step-card">
                    <h3>Poller detects change (ETag mismatch)</h3>
                    <p>Every 2 minutes, Klarity sends a conditional <code>GET</code> with <code>If-None-Match</code>. This time, GitHub returns <code>200</code> instead of <code>304</code> ‚Äî new content.</p>
                    <div class="detail">
                        <code>GET /repos/{user}/.taskboard/contents/inbox.json</code><br>
                        Header: <code>If-None-Match: "prev-etag"</code><br>
                        Response: <code>200 OK</code> (content changed!)<br>
                        <br>
                        Most polls return <code>304 Not Modified</code> ‚Äî zero bandwidth.
                    </div>
                    <div class="timing">Every 2 minutes (configurable)</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number klarity">5</div>
                <div class="step-card">
                    <h3>Merge remote items with local state</h3>
                    <p>New items from Orbit are merged into the local inbox. Existing items get their replies merged. New items are marked <code>read: false</code> for the badge.</p>
                    <div class="detail">
                        Remote: 8 items (1 new)<br>
                        Local: 7 items<br>
                        Merged: 8 items, <code>newCount = 1</code>
                    </div>
                </div>
            </div>

            <div class="step">
                <div class="step-number klarity">6</div>
                <div class="step-card">
                    <h3>Write merged data to local ~/.taskboard/</h3>
                    <p>The merged inbox is written to the local filesystem. This is the trigger that connects to the Rust file watcher.</p>
                    <div class="detail">
                        <code>~/.taskboard/inbox.json</code> ‚Üê structured data<br>
                        <code>~/.taskboard/inbox.md</code> ‚Üê regenerated for Claude
                    </div>
                </div>
            </div>
        </div>

        <!-- NOTIFICATION -->
        <div class="phase">
            <div class="phase-label notify-phase">Windows Notification</div>

            <div class="step">
                <div class="step-number notify">7</div>
                <div class="step-card">
                    <h3>Rust file watcher detects inbox.json change</h3>
                    <p>The <code>notify</code> crate watches <code>~/.taskboard/</code>. When <code>inbox.json</code> is modified, it compares item IDs against the previous state and finds new entries.</p>
                    <div class="detail">
                        watcher.rs ‚Üí <code>check_and_notify()</code><br>
                        Previous IDs: [inbox-1..7]<br>
                        Current IDs: [inbox-1..8] ‚Üí <strong>1 new item detected</strong>
                    </div>
                </div>
            </div>

            <div class="step">
                <div class="step-number notify">8</div>
                <div class="step-card">
                    <h3>Windows toast notification fires</h3>
                    <p>A native Windows notification appears with the item preview. The user sees it even if Klarity is minimized.</p>
                    <div class="notif-mock">
                        <div class="notif-icon">üîî</div>
                        <div class="notif-content">
                            <div class="notif-title">1 new inbox item</div>
                            <div class="notif-body">Fix splash screen timing ‚Äî the splash disappears too quickly on cold start.</div>
                            <div class="notif-app">Klarity</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="step">
                <div class="step-number notify">9</div>
                <div class="step-card">
                    <h3>Inbox badge updates in Klarity UI</h3>
                    <p>The frontend receives an <code>inbox-updated</code> event via Tauri's event system. The unread badge on the Inbox tab increments. User clicks to see the new item and reply.</p>
                    <div class="data-badge">inbox-updated event emitted</div>
                    <div class="data-badge">badge count: 3</div>
                </div>
            </div>
        </div>

        <!-- CLAUDE SESSION -->
        <div class="phase">
            <div class="phase-label claude-phase">Claude Code Session (VS Code)</div>

            <div class="step">
                <div class="step-number claude">10</div>
                <div class="step-card">
                    <h3>Claude pulls latest from GitHub, then reads inbox</h3>
                    <p>First action: <code>bash ~/.taskboard/sync-pull.sh</code> to get Orbit's latest messages directly from GitHub ‚Äî even if Klarity hasn't been running. Then reads the local <code>inbox.json</code> and presents <strong>all pending/unread</strong> items.</p>
                    <div class="detail">
                        <code>$ bash ~/.taskboard/sync-pull.sh</code><br>
                        <code>[sync-pull] Pulled successfully! 8 item(s) in inbox.</code><br><br>
                        Claude: "You have 3 pending inbox items:"<br>
                        1. <strong>[P0 ¬∑ TASK]</strong> Fix splash screen timing <span style="color:#a78bfa">@taskboard</span><br>
                        2. <strong>[IDEA]</strong> Research Whisper alternatives <span style="color:#a78bfa">@tradevoice</span><br>
                        3. <strong>[TASK]</strong> Set up CI/CD pipeline <span style="color:#a78bfa">@taskboard</span><br>
                        <br>
                        "Which item would you like to action?"
                    </div>
                    <div class="data-badge">sync-pull.sh</div>
                    <div class="data-badge">Orbit ‚Üí GitHub ‚Üí Claude</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number claude">11</div>
                <div class="step-card">
                    <h3>User selects action mode</h3>
                    <p>User picks an inbox item and chooses how to handle it ‚Äî either do it themselves (manual) or let Claude execute it.</p>
                    <div class="detail">
                        <strong>Option A:</strong> "I'll handle this myself" ‚Üí Claude marks item acknowledged<br>
                        <strong>Option B:</strong> "Claude, execute this" ‚Üí Claude proceeds to step 12<br>
                        <strong>Option C:</strong> "Skip / mark done" ‚Üí Claude updates status directly
                    </div>
                    <div class="data-badge">user decision point</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number claude">12</div>
                <div class="step-card">
                    <h3>Claude executes the task</h3>
                    <p>Claude performs the requested work ‚Äî fixing code, writing tests, updating configs, creating files, running builds. All actions are tracked and results collected.</p>
                    <div class="detail">
                        Example: "Fix splash screen timing"<br>
                        ‚Üí Reads <code>SplashScreen.tsx</code><br>
                        ‚Üí Edits delay from 500ms to 2000ms<br>
                        ‚Üí Adds keyboard dismiss handler<br>
                        ‚Üí Runs <code>npx tsc --noEmit</code> ‚Üí compiles clean<br>
                        ‚Üí Runs tests ‚Üí all pass
                    </div>
                    <div class="data-badge">code changes</div>
                    <div class="data-badge">build verified</div>
                    <div class="data-badge">tests pass</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number claude">13</div>
                <div class="step-card">
                    <h3>Claude writes response + status to local inbox.json</h3>
                    <p>After execution, Claude edits <code>~/.taskboard/inbox.json</code> directly. Adds a reply with results summary, sets task status to <code>done</code>, and marks <code>read: false</code> for the Klarity badge.</p>
                    <div class="detail">
                        Edits: <code>~/.taskboard/inbox.json</code><br><br>
                        <strong>Reply added:</strong><br>
                        {<br>
                        &nbsp;&nbsp;"id": "reply-1706234567890",<br>
                        &nbsp;&nbsp;"author": "claude",<br>
                        &nbsp;&nbsp;"text": "Fixed! Splash delay ‚Üí 2s, added keyboard dismiss. Build clean, tests pass.",<br>
                        &nbsp;&nbsp;"createdAt": "2026-01-31T14:35:00.000Z"<br>
                        }<br><br>
                        <strong>Status updated:</strong> <code>"pending"</code> ‚Üí <code>"done"</code><br>
                        <strong>Read flag:</strong> <code>read: false</code> (triggers badge)
                    </div>
                    <div class="data-badge">reply with results</div>
                    <div class="data-badge">status: done</div>
                    <div class="data-badge">read: false</div>
                </div>
            </div>

            <div class="step">
                <div class="step-number claude">14</div>
                <div class="step-card">
                    <h3>Claude pushes directly to GitHub (Orbit gets it immediately)</h3>
                    <p>Claude runs <code>bash ~/.taskboard/sync-push.sh</code> which uses <code>curl</code> to push <code>inbox.json</code> directly to the <code>.taskboard</code> GitHub repo via Contents API. <strong>Orbit gets the reply without needing Klarity to be running.</strong></p>
                    <div class="detail">
                        <code>$ bash ~/.taskboard/sync-push.sh</code><br><br>
                        1. Reads token + owner from <code>sync-config.json</code><br>
                        2. GET current SHA from GitHub<br>
                        3. Base64-encode local <code>inbox.json</code><br>
                        4. PUT to <code>/repos/{user}/.taskboard/contents/inbox.json</code><br>
                        5. Commit message: "Sync inbox ‚Äî via Claude Code"
                    </div>
                    <div class="data-badge">direct push</div>
                    <div class="data-badge">Orbit independent</div>
                    <div class="data-badge">curl + GitHub API</div>
                </div>
            </div>
        </div>

        <!-- KLARITY BACKUP SYNC -->
        <div class="phase">
            <div class="phase-label sync-phase">Klarity Backup Sync (if open)</div>

            <div class="step">
                <div class="step-number sync">15</div>
                <div class="step-card">
                    <h3>Klarity also detects the change and pushes (backup)</h3>
                    <p>If Klarity is open, the Rust file watcher and <code>useDataLoader</code> will also detect the local inbox.json change and push via <code>pushInboxToRepo()</code>. This is a <strong>backup path</strong> ‚Äî not required for Orbit to receive the reply.</p>
                    <div class="detail">
                        watcher.rs ‚Üí detects file change ‚Üí Windows toast notification<br>
                        useDataLoader ‚Üí inbox changed ‚Üí <code>pushInboxToRepo()</code><br>
                        <br>
                        <strong>If Klarity is closed:</strong> No problem ‚Äî Claude already pushed in step 14.<br>
                        <strong>If Klarity is open:</strong> Additive merge handles the duplicate push gracefully.
                    </div>
                    <div class="data-badge">backup path</div>
                    <div class="data-badge">badge + toast</div>
                </div>
            </div>
        </div>

        <!-- ORBIT RECEIVES -->
        <div class="phase">
            <div class="phase-label orbit-phase">Orbit Receives Reply</div>

            <div class="step">
                <div class="step-number orbit">16</div>
                <div class="step-card">
                    <h3>Orbit shows Claude's reply and task status on phone</h3>
                    <p>When the user opens Orbit, it pulls <code>inbox.json</code> from GitHub. Claude's reply appears in the conversation thread. The task status shows <code>done</code>. The full sync loop is complete.</p>
                    <div class="detail">
                        User opens Orbit ‚Üí fetches inbox.json from GitHub<br><br>
                        <strong>Inbox thread:</strong><br>
                        You: "Fix splash screen timing ‚Äî disappears too quickly"<br>
                        Claude: "Fixed! Splash delay ‚Üí 2s, added keyboard dismiss. Build clean, tests pass."<br><br>
                        <strong>Status badge:</strong> ‚úÖ Done
                    </div>
                    <div class="data-badge">reply visible</div>
                    <div class="data-badge">status: done</div>
                    <div class="data-badge">loop complete</div>
                </div>
            </div>
        </div>

    </div>

    <!-- LOOP INDICATOR -->
    <div class="loop-indicator">
        <div class="loop-icon">üîÑ</div>
        <div class="loop-text">Full bidirectional sync ‚Äî Orbit ‚Üî Claude work independently, Klarity is optional</div>
        <div class="loop-sub">Orbit captures ‚Üí GitHub stores ‚Üí <strong>Claude pulls from GitHub</strong> ‚Üí User acts ‚Üí Claude executes ‚Üí Writes reply ‚Üí <strong>Pushes to GitHub</strong> ‚Üí Orbit shows result ¬∑ Klarity polls + notifies (if open)</div>
    </div>

    <!-- ===== PROTOCOLS ===== -->
    <div class="protocol-section">
        <div class="section-title">
            <h2>Key Protocols</h2>
            <div class="line"></div>
        </div>

        <div class="protocol-grid">
            <div class="protocol-card etag">
                <div class="pc-label">ETag Caching</div>
                <div class="pc-title">Zero-cost when idle</div>
                <div class="pc-desc">GitHub returns <code>304 Not Modified</code> when nothing changed. Doesn't count against API rate limit. Most polls cost zero bandwidth.</div>
            </div>

            <div class="protocol-card merge">
                <div class="pc-label">Additive Merge</div>
                <div class="pc-title">No data loss</div>
                <div class="pc-desc">Items merge by ID. Replies merge by ID. Status uses "most progressed wins" (done > skipped > pending). Never overwrites, only appends.</div>
            </div>

            <div class="protocol-card notify">
                <div class="pc-label">Dual Notification</div>
                <div class="pc-title">Never miss a message</div>
                <div class="pc-desc">Windows toast for attention. In-app badge for count. Tauri event for real-time UI updates. Three layers, all automatic.</div>
            </div>

            <div class="protocol-card pushback">
                <div class="pc-label">Direct Push</div>
                <div class="pc-title">Orbit independent</div>
                <div class="pc-desc">Claude pushes to GitHub directly via <code>sync-push.sh</code> (curl). Orbit gets replies without Klarity. Klarity push is backup only. SHA-tracked, 409 auto-retry.</div>
            </div>
        </div>
    </div>

    <!-- ===== CONFIG EXAMPLE ===== -->
    <div class="config-section">
        <div class="section-title">
            <h2>Configuration</h2>
            <div class="line"></div>
        </div>

        <div class="config-block">
            <span class="comment">// ~/.taskboard/sync-config.json</span><br>
            {<br>
            &nbsp;&nbsp;<span class="key">"github"</span>: {<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"token"</span>: <span class="str">"ghp_..."</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// GitHub PAT with repo scope</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"owner"</span>: <span class="str">"castroarun"</span>,&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// GitHub username</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span class="key">"pollIntervalMs"</span>: <span class="num">120000</span>&nbsp;&nbsp;<span class="comment">// 2 minutes (default)</span><br>
            &nbsp;&nbsp;}<br>
            }
        </div>
    </div>

    <!-- ===== LEGEND ===== -->
    <div class="legend">
        <div class="legend-item">
            <div class="legend-dot orbit"></div>
            Orbit (phone)
        </div>
        <div class="legend-item">
            <div class="legend-dot github"></div>
            GitHub API
        </div>
        <div class="legend-item">
            <div class="legend-dot klarity"></div>
            Klarity (desktop)
        </div>
        <div class="legend-item">
            <div class="legend-dot notify"></div>
            Notification
        </div>
        <div class="legend-item">
            <div class="legend-dot claude"></div>
            Claude Code
        </div>
        <div class="legend-item">
            <div class="legend-dot sync"></div>
            Sync loop
        </div>
    </div>

    <!-- ===== LINKEDIN COMPACT VERSION ===== -->
    <div class="linkedin-section">
        <div class="linkedin-badge">Zero-server sync ‚Äî phone, desktop, and AI agents stay in sync via GitHub alone</div>

        <!-- FLOW 1: Direct (Orbit ‚Üí Claude) -->
        <div class="linkedin-card" style="margin-bottom: 24px;">
            <div class="lc-title">Phone ‚Üí AI ‚Üí Done</div>
            <div class="lc-subtitle">Capture tasks from your phone. AI agent executes them. Results sync back ‚Äî no laptop needed.</div>

            <div style="font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: #34d399; margin-bottom: 16px; text-align: center;">Direct Flow ‚Äî Orbit independent</div>

            <div class="linkedin-flow">
                <div class="lf-node">
                    <div class="lf-icon orbit-bg">üì±</div>
                    <div class="lf-name">Orbit</div>
                    <div class="lf-role">Capture</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon github-bg">‚òÅÔ∏è</div>
                    <div class="lf-name">GitHub</div>
                    <div class="lf-role">Sync Layer</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon claude-bg">‚ö°</div>
                    <div class="lf-name">Claude</div>
                    <div class="lf-role">AI Agent</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon github-bg">‚òÅÔ∏è</div>
                    <div class="lf-name">GitHub</div>
                    <div class="lf-role">Result</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon orbit-bg">üì±</div>
                    <div class="lf-name">Orbit</div>
                    <div class="lf-role">Done</div>
                </div>
            </div>

            <!-- FLOW 2: With Klarity -->
            <div style="font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: #22d3ee; margin-bottom: 16px; text-align: center; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.06);">With Klarity ‚Äî Desktop notifications + real-time UI</div>

            <div class="linkedin-flow">
                <div class="lf-node">
                    <div class="lf-icon orbit-bg">üì±</div>
                    <div class="lf-name">Orbit</div>
                    <div class="lf-role">Capture</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon github-bg">‚òÅÔ∏è</div>
                    <div class="lf-name">GitHub</div>
                    <div class="lf-role">Sync Layer</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon klarity-bg">üñ•Ô∏è</div>
                    <div class="lf-name">Klarity</div>
                    <div class="lf-role">Notify + Badge</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon claude-bg">‚ö°</div>
                    <div class="lf-name">Claude</div>
                    <div class="lf-role">AI Agent</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon klarity-bg">üñ•Ô∏è</div>
                    <div class="lf-name">Klarity</div>
                    <div class="lf-role">Dashboard</div>
                </div>
            </div>

            <!-- FLOW 3: Full System ‚Äî Both Orbit + Klarity active -->
            <div style="font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: #f472b6; margin-bottom: 16px; text-align: center; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.06);">Full System ‚Äî Orbit + Klarity + Claude all active</div>

            <div class="linkedin-flow" style="margin-bottom: 12px;">
                <div class="lf-node">
                    <div class="lf-icon orbit-bg">üì±</div>
                    <div class="lf-name">Orbit</div>
                    <div class="lf-role">Capture</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon github-bg">‚òÅÔ∏è</div>
                    <div class="lf-name">GitHub</div>
                    <div class="lf-role">Central Hub</div>
                </div>
                <div class="lf-arrow" style="font-size: 14px; color: #71717a;">‚§µ</div>
                <div style="display: flex; flex-direction: column; align-items: center; gap: 6px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 14px; padding: 12px 16px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="lf-icon klarity-bg" style="width: 40px; height: 40px; font-size: 18px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">üñ•Ô∏è</div>
                        <div style="text-align: left;">
                            <div class="lf-name">Klarity</div>
                            <div class="lf-role">Notify + Badge</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="lf-icon claude-bg" style="width: 40px; height: 40px; font-size: 18px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">‚ö°</div>
                        <div style="text-align: left;">
                            <div class="lf-name">Claude</div>
                            <div class="lf-role">Pull + Execute</div>
                        </div>
                    </div>
                    <div style="font-size: 8px; color: #52525b; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 2px;">Both receive independently</div>
                </div>
                <div class="lf-arrow">‚Üí</div>
                <div class="lf-node">
                    <div class="lf-icon github-bg">‚òÅÔ∏è</div>
                    <div class="lf-name">GitHub</div>
                    <div class="lf-role">Result</div>
                </div>
                <div class="lf-arrow" style="font-size: 14px; color: #71717a;">‚§µ</div>
                <div style="display: flex; flex-direction: column; align-items: center; gap: 6px; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 14px; padding: 12px 16px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="lf-icon orbit-bg" style="width: 40px; height: 40px; font-size: 18px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">üì±</div>
                        <div style="text-align: left;">
                            <div class="lf-name">Orbit</div>
                            <div class="lf-role">Reply on phone</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="lf-icon klarity-bg" style="width: 40px; height: 40px; font-size: 18px; border-radius: 10px; display: flex; align-items: center; justify-content: center;">üñ•Ô∏è</div>
                        <div style="text-align: left;">
                            <div class="lf-name">Klarity</div>
                            <div class="lf-role">Dashboard updated</div>
                        </div>
                    </div>
                    <div style="font-size: 8px; color: #52525b; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 2px;">Both show result</div>
                </div>
            </div>
            <div style="text-align: center; font-size: 11px; color: #71717a; margin-bottom: 4px;">SHA conflict protection + additive merge = zero data loss</div>

            <div class="linkedin-features">
                <div class="linkedin-feat">
                    <div class="feat-num">4</div>
                    <div class="feat-label">Systems synced</div>
                </div>
                <div class="linkedin-feat">
                    <div class="feat-num">0</div>
                    <div class="feat-label">Backend servers</div>
                </div>
                <div class="linkedin-feat">
                    <div class="feat-num">&lt;2m</div>
                    <div class="feat-label">Sync latency</div>
                </div>
                <div class="linkedin-feat">
                    <div class="feat-num">$0</div>
                    <div class="feat-label">Infrastructure cost</div>
                </div>
            </div>

            <div class="linkedin-tech-row">
                <div class="linkedin-tech">React Native</div>
                <div class="linkedin-tech">Tauri 2.0</div>
                <div class="linkedin-tech">Rust</div>
                <div class="linkedin-tech">TypeScript</div>
                <div class="linkedin-tech">GitHub API</div>
                <div class="linkedin-tech">Claude AI</div>
            </div>
        </div>
    </div>

    <div class="footer">
        Klarity + Orbit Sync Architecture v4.2 ‚Äî LIVE ‚Äî Full System Sync ‚Äî Jan 2026
    </div>

</body>
</html>
